(() => {
    const NIKOCAL_URL = 'http://172.24.212.83:3001/';
    const CHECK_INTERVAL = 5;
    const KEY_NIKOCAL_DATE = 'nikocal_date';
    const NOTIFY_NIKOCAL_HOUR = 18;
    const NOTIFY_NIKOCAL_MINUTE = 50;
    const NOTIFY_NIKOCAL_SECOND = 0;
    const NOTIFY_TIMEPRO_WEEK = 1;
    const NOTIFY_TIMEPRO_HOUR = 10;
    const NOTIFY_TIMEPRO_MINUTE = 0;
    const NOTIFY_TIMEPRO_SECOND = 0;
    function show() {
        chrome.browserAction.setIcon({ path: 'icon1.png' });
        chrome.browserAction.setBadgeText({ text: 'open' });
        chrome.browserAction.setBadgeBackgroundColor({ color: [200, 0, 0, 255] });
    }
    function hide() {
        chrome.browserAction.setIcon({ path: 'icon2.png' });
        chrome.browserAction.setBadgeText({ text: '' });
        clearNotification();
    }
    /**
     * 取得した日で新しいデータ作成
     */
    function getNewNicoCalData() {
        var date = new Date();
        date.setHours(NOTIFY_NIKOCAL_HOUR);
        date.setMinutes(NOTIFY_NIKOCAL_MINUTE);
        date.setSeconds(NOTIFY_NIKOCAL_SECOND);
        return {
            notifyDate: date.getTime(),
            isNotify: false
        };
    }
    function getNikoCalDataAsyc() {
        return new Promise((resolve) => {
            chrome.storage.local.get('nikocal_date', (items) => {
                var nikocalData = items['nikocal_date'];
                if (!nikocalData) {
                    nikocalData = getNewNicoCalData();
                    setNikoCalDataAsyc(nikocalData);
                }
                resolve(nikocalData);
            });
        });
    }
    function setNikoCalDataAsyc(nikocalData) {
        chrome.storage.local.set({
            'nikocal_date': nikocalData
        });
    }
    function onOpenNikoCal() {
        getNikoCalDataAsyc().
            then((nikocalData) => {
            if (nikocalData.notifyDate < Date.now()) {
                nikocalData.isNotify = true;
                setNikoCalDataAsyc(nikocalData);
            }
        });
    }
    function clearNotification() {
        chrome.notifications.getAll((notifications) => {
            for (var notificationId in notifications) {
                chrome.notifications.clear(notificationId);
            }
        });
    }
    function showNikocalNotification() {
        chrome.notifications.create({
            type: 'basic',
            iconUrl: 'icon2.png',
            title: 'ニコニコカレンダーよりお知らせ',
            message: 'そろそろ入力したら？'
        });
        chrome.notifications.onClicked.addListener((notificationId) => {
            chrome.tabs.create({
                url: NIKOCAL_URL
            });
            clearNotification();
            onOpenNikoCal();
        });
    }
    function showWBSNotification() {
        chrome.notifications.create({
            type: 'basic',
            iconUrl: 'icon2.png',
            title: 'ニコニコカレンダーよりお知らせ',
            message: 'TimeProとWBSの入力はした？'
        });
        chrome.notifications.onClicked.addListener((notificationId) => {
            chrome.tabs.create({
                url: 'http://timepro/xgweb/login.asp/'
            });
            chrome.notifications.clear(notificationId);
        });
    }
    function checkOpenNikoCal() {
        getNikoCalDataAsyc().
            then((nikocalData) => {
            var notifyDate = new Date(nikocalData.notifyDate);
            var notifyMonth = notifyDate.getMonth();
            var notifyDay = notifyDate.getDate();
            var currentDate = new Date();
            var currentMonth = currentDate.getMonth();
            var currentDay = currentDate.getDate();
            if (notifyMonth != currentMonth || notifyDay < currentDay) {
                nikocalData = getNewNicoCalData();
                setNikoCalDataAsyc(nikocalData);
                hide();
            }
            else if (notifyDate < currentDate) {
                show();
                if (!nikocalData.isNotify) {
                    showNikocalNotification();
                }
            }
            else {
                hide();
            }
        });
    }
    chrome.browserAction.onClicked.addListener(() => {
        onOpenNikoCal();
        chrome.tabs.create({
            url: NIKOCAL_URL
        });
    });
    chrome.alarms.create('nikocal', { periodInMinutes: CHECK_INTERVAL });
    chrome.alarms.onAlarm.addListener(function (alarm) {
        if (alarm.name === 'nikocal') {
            checkOpenNikoCal();
        }
    });
    checkOpenNikoCal();
})();

//# sourceMappingURL=data:application/json;base64,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QyxJQUFJLENBQUMsTUFBTSxDQUFDO1lBQ2pCLEdBQUcsRUFBRSxXQUFXO1NBQ2pCLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ0gsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsU0FBUyxFQUFFLEVBQUUsZUFBZSxFQUFFLGNBQWMsRUFBRSxDQUFDLENBQUM7SUFDckUsTUFBTSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLFVBQVMsS0FBMEI7UUFDbkUsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDO1lBQzdCLGdCQUFnQixFQUFFLENBQUM7UUFDckIsQ0FBQztJQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0gsZ0JBQWdCLEVBQUUsQ0FBQztBQUNyQixDQUFDLENBQUMsRUFBRSxDQUFDIiwiZmlsZSI6ImJhY2tncm91bmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoKCkgPT4ge1xyXG4gIGNvbnN0IE5JS09DQUxfVVJMID0gJ2h0dHA6Ly8xNzIuMjQuMjEyLjgzOjMwMDEvJztcclxuICBcclxuICBjb25zdCBDSEVDS19JTlRFUlZBTCA9IDU7XHJcbiAgXHJcbiAgY29uc3QgS0VZX05JS09DQUxfREFURSA9ICduaWtvY2FsX2RhdGUnXHJcbiAgY29uc3QgTk9USUZZX05JS09DQUxfSE9VUiA9IDE4O1xyXG4gIGNvbnN0IE5PVElGWV9OSUtPQ0FMX01JTlVURSA9IDUwO1xyXG4gIGNvbnN0IE5PVElGWV9OSUtPQ0FMX1NFQ09ORCA9IDA7XHJcblxyXG4gIGNvbnN0IE5PVElGWV9USU1FUFJPX1dFRUsgPSAxO1xyXG4gIGNvbnN0IE5PVElGWV9USU1FUFJPX0hPVVIgPSAxMDtcclxuICBjb25zdCBOT1RJRllfVElNRVBST19NSU5VVEUgPSAwO1xyXG4gIGNvbnN0IE5PVElGWV9USU1FUFJPX1NFQ09ORCA9IDA7XHJcbiAgXHJcbiAgaW50ZXJmYWNlIElOaWtvbmlrb0RhdGEge1xyXG4gICAgbm90aWZ5RGF0ZTogbnVtYmVyO1xyXG4gICAgaXNOb3RpZnk6IGJvb2xlYW47XHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIHNob3coKSB7XHJcbiAgICBjaHJvbWUuYnJvd3NlckFjdGlvbi5zZXRJY29uKHsgcGF0aDogJ2ljb24xLnBuZycgfSk7XHJcbiAgICBjaHJvbWUuYnJvd3NlckFjdGlvbi5zZXRCYWRnZVRleHQoeyB0ZXh0OiAnb3BlbicgfSk7XHJcbiAgICBjaHJvbWUuYnJvd3NlckFjdGlvbi5zZXRCYWRnZUJhY2tncm91bmRDb2xvcih7IGNvbG9yOiBbMjAwLCAwLCAwLCAyNTVdIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaGlkZSgpIHtcclxuICAgIGNocm9tZS5icm93c2VyQWN0aW9uLnNldEljb24oeyBwYXRoOiAnaWNvbjIucG5nJyB9KTtcclxuICAgIGNocm9tZS5icm93c2VyQWN0aW9uLnNldEJhZGdlVGV4dCh7IHRleHQ6ICcnIH0pO1xyXG4gICAgY2xlYXJOb3RpZmljYXRpb24oKTtcclxuICB9XHJcbiAgXHJcbiAgLyoqXHJcbiAgICog5Y+W5b6X44GX44Gf5pel44Gn5paw44GX44GE44OH44O844K/5L2c5oiQXHJcbiAgICovXHJcbiAgZnVuY3Rpb24gZ2V0TmV3Tmljb0NhbERhdGEoKTogSU5pa29uaWtvRGF0YSB7XHJcbiAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBkYXRlLnNldEhvdXJzKE5PVElGWV9OSUtPQ0FMX0hPVVIpO1xyXG4gICAgZGF0ZS5zZXRNaW51dGVzKE5PVElGWV9OSUtPQ0FMX01JTlVURSk7XHJcbiAgICBkYXRlLnNldFNlY29uZHMoTk9USUZZX05JS09DQUxfU0VDT05EKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5vdGlmeURhdGU6IGRhdGUuZ2V0VGltZSgpLFxyXG4gICAgICBpc05vdGlmeTogZmFsc2VcclxuICAgIH07XHJcbiAgfSBcclxuICBcclxuICBmdW5jdGlvbiBnZXROaWtvQ2FsRGF0YUFzeWMoKTogUHJvbWlzZTxJTmlrb25pa29EYXRhPiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2U8SU5pa29uaWtvRGF0YT4oKHJlc29sdmU6IChuaWtvY2FsRGF0YTogSU5pa29uaWtvRGF0YSkgPT4gdm9pZCkgPT4ge1xyXG4gICAgICBjaHJvbWUuc3RvcmFnZS5sb2NhbC5nZXQoJ25pa29jYWxfZGF0ZScsIChpdGVtczogeyBba2V5OiBzdHJpbmddOiBhbnkgfSkgPT4ge1xyXG4gICAgICAgIHZhciBuaWtvY2FsRGF0YSA9IGl0ZW1zWyduaWtvY2FsX2RhdGUnXTtcclxuICAgICAgICBpZighbmlrb2NhbERhdGEpIHtcclxuICAgICAgICAgIG5pa29jYWxEYXRhID0gZ2V0TmV3Tmljb0NhbERhdGEoKTtcclxuICAgICAgICAgIHNldE5pa29DYWxEYXRhQXN5YyhuaWtvY2FsRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJlc29sdmUobmlrb2NhbERhdGEpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICBmdW5jdGlvbiBzZXROaWtvQ2FsRGF0YUFzeWMobmlrb2NhbERhdGE6IElOaWtvbmlrb0RhdGEpOiB2b2lkIHtcclxuICAgIGNocm9tZS5zdG9yYWdlLmxvY2FsLnNldCh7XHJcbiAgICAgICduaWtvY2FsX2RhdGUnOiBuaWtvY2FsRGF0YVxyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIG9uT3Blbk5pa29DYWwoKTogdm9pZCB7IFxyXG4gICAgZ2V0Tmlrb0NhbERhdGFBc3ljKCkuXHJcbiAgICAgIHRoZW4oKG5pa29jYWxEYXRhOiBJTmlrb25pa29EYXRhKSA9PiB7XHJcbiAgICAgICAgaWYgKG5pa29jYWxEYXRhLm5vdGlmeURhdGUgPCBEYXRlLm5vdygpKSB7XHJcbiAgICAgICAgICBuaWtvY2FsRGF0YS5pc05vdGlmeSA9IHRydWU7XHJcbiAgICAgICAgICBzZXROaWtvQ2FsRGF0YUFzeWMobmlrb2NhbERhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIGNsZWFyTm90aWZpY2F0aW9uKCk6IHZvaWQgeyBcclxuICAgIGNocm9tZS5ub3RpZmljYXRpb25zLmdldEFsbCgobm90aWZpY2F0aW9uczoge1tpbmRleDogc3RyaW5nXTogYm9vbGVhbn0pID0+IHtcclxuICAgICAgZm9yICh2YXIgbm90aWZpY2F0aW9uSWQgaW4gbm90aWZpY2F0aW9ucykgeyBcclxuICAgICAgICBjaHJvbWUubm90aWZpY2F0aW9ucy5jbGVhcihub3RpZmljYXRpb25JZCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuICBcclxuICBmdW5jdGlvbiBzaG93Tmlrb2NhbE5vdGlmaWNhdGlvbigpIHtcclxuICAgIGNocm9tZS5ub3RpZmljYXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIHR5cGU6ICdiYXNpYycsXHJcbiAgICAgIGljb25Vcmw6ICdpY29uMi5wbmcnLFxyXG4gICAgICB0aXRsZTogJ+ODi+OCs+ODi+OCs+OCq+ODrOODs+ODgOODvOOCiOOCiuOBiuefpeOCieOBmycsXHJcbiAgICAgIG1lc3NhZ2U6ICfjgZ3jgo3jgZ3jgo3lhaXlipvjgZfjgZ/jgonvvJ8nXHJcbiAgICB9KTtcclxuICAgIGNocm9tZS5ub3RpZmljYXRpb25zLm9uQ2xpY2tlZC5hZGRMaXN0ZW5lcigobm90aWZpY2F0aW9uSWQ6IHN0cmluZykgPT4ge1xyXG4gICAgICBjaHJvbWUudGFicy5jcmVhdGUoe1xyXG4gICAgICAgIHVybDogTklLT0NBTF9VUkxcclxuICAgICAgfSk7XHJcbiAgICAgIGNsZWFyTm90aWZpY2F0aW9uKCk7XHJcbiAgICAgIG9uT3Blbk5pa29DYWwoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gc2hvd1dCU05vdGlmaWNhdGlvbigpIHtcclxuICAgIGNocm9tZS5ub3RpZmljYXRpb25zLmNyZWF0ZSh7XHJcbiAgICAgIHR5cGU6ICdiYXNpYycsXHJcbiAgICAgIGljb25Vcmw6ICdpY29uMi5wbmcnLFxyXG4gICAgICB0aXRsZTogJ+ODi+OCs+ODi+OCs+OCq+ODrOODs+ODgOODvOOCiOOCiuOBiuefpeOCieOBmycsXHJcbiAgICAgIG1lc3NhZ2U6ICdUaW1lUHJv44GoV0JT44Gu5YWl5Yqb44Gv44GX44Gf77yfJ1xyXG4gICAgfSk7XHJcbiAgICBjaHJvbWUubm90aWZpY2F0aW9ucy5vbkNsaWNrZWQuYWRkTGlzdGVuZXIoKG5vdGlmaWNhdGlvbklkOiBzdHJpbmcpID0+IHtcclxuICAgICAgY2hyb21lLnRhYnMuY3JlYXRlKHtcclxuICAgICAgICB1cmw6ICdodHRwOi8vdGltZXByby94Z3dlYi9sb2dpbi5hc3AvJ1xyXG4gICAgICB9KTtcclxuICAgICAgY2hyb21lLm5vdGlmaWNhdGlvbnMuY2xlYXIobm90aWZpY2F0aW9uSWQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIGZ1bmN0aW9uIGNoZWNrT3Blbk5pa29DYWwoKSB7XHJcbiAgICBnZXROaWtvQ2FsRGF0YUFzeWMoKS5cclxuICAgICAgdGhlbigobmlrb2NhbERhdGE6IElOaWtvbmlrb0RhdGEpID0+IHtcclxuICAgICAgICB2YXIgbm90aWZ5RGF0ZSA9IG5ldyBEYXRlKG5pa29jYWxEYXRhLm5vdGlmeURhdGUpO1xyXG4gICAgICAgIHZhciBub3RpZnlNb250aCA9IG5vdGlmeURhdGUuZ2V0TW9udGgoKTtcclxuICAgICAgICB2YXIgbm90aWZ5RGF5ID0gbm90aWZ5RGF0ZS5nZXREYXRlKCk7XHJcbiAgICAgICAgdmFyIGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICB2YXIgY3VycmVudE1vbnRoID0gY3VycmVudERhdGUuZ2V0TW9udGgoKTtcclxuICAgICAgICB2YXIgY3VycmVudERheSA9IGN1cnJlbnREYXRlLmdldERhdGUoKTtcclxuICAgICAgICBpZihub3RpZnlNb250aCAhPSBjdXJyZW50TW9udGggfHwgbm90aWZ5RGF5IDwgY3VycmVudERheSkge1xyXG4gICAgICAgICAgbmlrb2NhbERhdGEgPSBnZXROZXdOaWNvQ2FsRGF0YSgpO1xyXG4gICAgICAgICAgc2V0Tmlrb0NhbERhdGFBc3ljKG5pa29jYWxEYXRhKTtcclxuICAgICAgICAgIGhpZGUoKTtcclxuICAgICAgICB9IGVsc2UgaWYobm90aWZ5RGF0ZSA8IGN1cnJlbnREYXRlKSB7XHJcbiAgICAgICAgICBzaG93KCk7XHJcbiAgICAgICAgICBpZighbmlrb2NhbERhdGEuaXNOb3RpZnkpIHtcclxuICAgICAgICAgICAgc2hvd05pa29jYWxOb3RpZmljYXRpb24oKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaGlkZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBjaHJvbWUuYnJvd3NlckFjdGlvbi5vbkNsaWNrZWQuYWRkTGlzdGVuZXIoKCkgPT4ge1xyXG4gICAgICBvbk9wZW5OaWtvQ2FsKCk7XHJcbiAgICAgIGNocm9tZS50YWJzLmNyZWF0ZSh7XHJcbiAgICAgICAgdXJsOiBOSUtPQ0FMX1VSTFxyXG4gICAgICB9KTtcclxuICB9KTtcclxuICBjaHJvbWUuYWxhcm1zLmNyZWF0ZSgnbmlrb2NhbCcsIHsgcGVyaW9kSW5NaW51dGVzOiBDSEVDS19JTlRFUlZBTCB9KTtcclxuICBjaHJvbWUuYWxhcm1zLm9uQWxhcm0uYWRkTGlzdGVuZXIoZnVuY3Rpb24oYWxhcm06IGNocm9tZS5hbGFybXMuQWxhcm0pIHtcclxuICAgIGlmIChhbGFybS5uYW1lID09PSAnbmlrb2NhbCcpIHtcclxuICAgICAgY2hlY2tPcGVuTmlrb0NhbCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIGNoZWNrT3Blbk5pa29DYWwoKTtcclxufSkoKTtcclxuXHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
